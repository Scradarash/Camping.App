<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Camping.App.ViewModels"
             xmlns:sys="clr-namespace:System;assembly=netstandard"
             x:Class="Camping.App.Views.ReserveringsoverzichtView"
             Title="Nieuwe Reservering">

    <ScrollView>
        <VerticalStackLayout Padding="20" BackgroundColor="White" Spacing="20">

            <!-- GRID MET 2 KOLOMMEN -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowDefinitions="Auto">

                <!-- KOLOM 1: Gegevens Reserveringshouder -->
                <Frame Grid.Column="0" BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Gegevens reserveringshouder" FontSize="20" FontAttributes="Bold" TextColor="Black" Margin="0,0,0,5"/>

                        <!-- Naam -->
                        <VerticalStackLayout Spacing="2">
                            <Label FontSize="16">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Volledige naam " TextColor="Black"/>
                                        <Span Text="(vereist)" TextColor="Red"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Entry Text="{Binding Naam}" Placeholder="Bijvoorbeeld: Jacob Arie Romkes" TextColor="Black" BackgroundColor="#f0f0f0"/>
                            <Label Text="{Binding NaamFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsNaamFoutZichtbaar}"/>
                        </VerticalStackLayout>

                        <!-- Geboortedatum -->
                        <VerticalStackLayout Spacing="2">
                            <Label FontSize="16">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Geboortedatum " TextColor="Black"/>
                                        <Span Text="(vereist)" TextColor="Red"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <DatePicker Date="{Binding Geboortedatum}" TextColor="Black" BackgroundColor="#f0f0f0" MaximumDate="{x:Static sys:DateTime.Today}"/>
                            <Label Text="{Binding GeboortedatumFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsGeboortedatumFoutZichtbaar}"/>
                        </VerticalStackLayout>

                        <!-- Email -->
                        <VerticalStackLayout Spacing="2">
                            <Label FontSize="16">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="E-mailadres " TextColor="Black"/>
                                        <Span Text="(vereist)" TextColor="Red"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Entry Text="{Binding Emailadres}" Keyboard="Email" Placeholder="bijvoorbeeld: jacobarieromkes@coolmail.com" TextColor="Black" BackgroundColor="#f0f0f0"/>
                            <Label Text="{Binding EmailadresFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsEmailadresFoutZichtbaar}"/>
                        </VerticalStackLayout>

                        <!-- Telefoon -->
                        <VerticalStackLayout Spacing="2">
                            <Label FontSize="16">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Telefoonnummer " TextColor="Black"/>
                                        <Span Text="(vereist)" TextColor="Red"/>
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Entry Text="{Binding Telefoonnummer}" Keyboard="Telephone" Placeholder="0612345678" TextColor="Black" BackgroundColor="#f0f0f0"/>
                            <Label Text="{Binding TelefoonnummerFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsTelefoonnummerFoutZichtbaar}"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- KOLOM 2: Gegevens Reservering -->
                <Frame Grid.Column="1" BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Gegevens reservering" FontSize="20" FontAttributes="Bold" TextColor="Black" Margin="0,0,0,5"/>

                        <!-- Veld & Plek Info -->
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                            <VerticalStackLayout>
                                <Label Text="Veld:" TextColor="Black" FontAttributes="Bold"/>
                                <Frame Padding="10" BackgroundColor="White" BorderColor="Gray" CornerRadius="5">
                                    <Label Text="{Binding FieldName}" TextColor="Black"/>
                                </Frame>
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="1">
                                <Label Text="Plaats:" TextColor="Black" FontAttributes="Bold"/>
                                <Frame Padding="10" BackgroundColor="White" BorderColor="Gray" CornerRadius="5">
                                    <Label Text="{Binding StaanplaatsNaam}" TextColor="Black" LineBreakMode="TailTruncation"/>
                                </Frame>
                            </VerticalStackLayout>
                        </Grid>

                        <Label Text="{Binding PeriodDescription}" TextColor="Gray" FontAttributes="Italic"/>

                        <BoxView HeightRequest="1" Color="LightGray" Margin="0,5"/>

                        <!-- Accommodatie Kiezen -->
                        <Label FontSize="16">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span Text="Accommodatie " TextColor="Black"/>
                                    <Span Text="(vereist)" TextColor="Red"/>
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>

                        <CollectionView ItemsSource="{Binding Accommodaties}" 
                                        SelectionMode="Single" 
                                        SelectedItem="{Binding SelectedAccommodatie}"
                                        HeightRequest="200">
                            <!-- Hoogte ingesteld zodat het in de stack past -->
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Stroke="Gray" StrokeThickness="1" Margin="0,5" Padding="10" BackgroundColor="White" StrokeShape="RoundRectangle 5">
                                        <VisualStateManager.VisualStateGroups>
                                            <VisualStateGroup Name="CommonStates">
                                                <VisualState Name="Selected">
                                                    <VisualState.Setters>
                                                        <Setter Property="BackgroundColor" Value="#cce5ff" />
                                                        <Setter Property="Stroke" Value="#0a5dc9" />
                                                    </VisualState.Setters>
                                                </VisualState>
                                                <VisualState Name="Normal" />
                                            </VisualStateGroup>
                                        </VisualStateManager.VisualStateGroups>

                                        <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="10">
                                            <!-- Naam -->
                                            <Label Text="{Binding Name}"
                                               VerticalOptions="Center"
                                               TextColor="Black"
                                               FontSize="16"/>

                                            <!-- Prijs -->
                                            <Label Text="{Binding PrijsTekst}"
                                               Grid.Column="1"
                                               VerticalOptions="Center"
                                               TextColor="Gray"
                                               FontSize="14"/>

                                            <!-- Vinkje als geselecteerd -->
                                            <Label Text="âœ”"
                                               Grid.Column="2"
                                               TextColor="#0a5dc9"
                                               FontAttributes="Bold"
                                               IsVisible="False">
                                                <Label.Triggers>
                                                    <DataTrigger TargetType="Label"
                                                         Binding="{Binding Source={RelativeSource AncestorType={x:Type Grid}}, Path=Parent.Parent.IsSelected}"
                                                         Value="True">
                                                        <Setter Property="IsVisible" Value="True"/>
                                                    </DataTrigger>
                                                </Label.Triggers>
                                            </Label>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <BoxView HeightRequest="1" Color="LightGray" Margin="0,5"/>

                        <!-- VOORZIENINGEN SECTIE -->
                        <Label Text="Voorzieningen:" TextColor="Black" FontAttributes="Bold"/>

                        <!-- Stroom -->
                        <Frame Padding="10" BackgroundColor="White" BorderColor="LightGray" CornerRadius="5" IsVisible="{Binding IsStroomMogelijk}">
                            <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                                <CheckBox IsChecked="{Binding KiestStroom}" Color="#0a5dc9"/>
                                <Label Text="âš¡" FontSize="20" VerticalOptions="Center" TextColor="Black"/>
                                <Label Text="{Binding StroomPrijsTekst}" VerticalOptions="Center" TextColor="Black"/>
                            </HorizontalStackLayout>
                        </Frame>
                        <Label Text="Geen stroom beschikbaar." TextColor="Gray" FontSize="12" IsVisible="False"/>

                        <!-- Water -->
                        <Frame Padding="10" BackgroundColor="White" BorderColor="LightGray" CornerRadius="5" IsVisible="{Binding IsWaterMogelijk}">
                            <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                                <CheckBox IsChecked="{Binding KiestWater}" Color="#0a5dc9"/>
                                <Label Text="ðŸ’§" FontSize="20" VerticalOptions="Center" TextColor="Black"/>
                                <Label Text="{Binding WaterPrijsTekst}" VerticalOptions="Center" TextColor="Black"/>
                            </HorizontalStackLayout>
                        </Frame>

                    </VerticalStackLayout>
                </Frame>

            </Grid>

            <!-- Totaalprijs label (dynamisch) -->
            <Label Text="{Binding TotaalPrijsTekst}" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   TextColor="Black"
                   Margin="5,10,0,0"/>

            <!-- Knoppenbalk -->
            <Grid ColumnDefinitions="Auto, *" Margin="0,10,0,0">
                <Button Grid.Column="0" 
                        Text="Terug" 
                        Command="{Binding GoBackCommand}" 
                        BackgroundColor="Gray" 
                        TextColor="White"
                        WidthRequest="100"/>

                <Button Grid.Column="1"
                        Text="Voltooi reservering"
                        Command="{Binding BevestigAccommodatieCommand}"
                        BackgroundColor="#0a5dc9"
                        TextColor="White"
                        FontAttributes="Bold"
                        HorizontalOptions="End"
                        WidthRequest="200"/>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>