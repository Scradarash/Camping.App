<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Camping.App.ViewModels"
             xmlns:sys="clr-namespace:System;assembly=netstandard"
             xmlns:models="clr-namespace:Camping.Core.Models;assembly=Camping.Core"
             x:Class="Camping.App.Views.ReserveringsoverzichtView"
             xmlns:Shell="http://schemas.microsoft.com/dotnet/2021/maui/shell">

    <!-- Titel met knoppen om terug te gaan -->
    <Shell.TitleView>
        <Grid HorizontalOptions="Fill" VerticalOptions="Center">
            <Label Text="Reserveringsoverzicht"
               FontSize="18"
               FontAttributes="Bold"
               TextColor="Black"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               HorizontalTextAlignment="Center"/>

            <!-- De Knop: staat links uitgelijnd bovenop de grid -->
            <Button Text="Terug"
                Command="{Binding GoBackCommand}" 
                HorizontalOptions="Start"
                VerticalOptions="Center"
                Margin="5,0,0,0" />
        </Grid>
    </Shell.TitleView>

    <Grid HorizontalOptions="Fill" VerticalOptions="Fill">
        <!-- Achtergrond afbeelding -->
        <Image Source="background.png"
               Aspect="AspectFill"
               HorizontalOptions="Fill"
               VerticalOptions="Fill" />

        <ScrollView>
            <VerticalStackLayout Padding="20" Spacing="20">

                <!-- GRID MET 2 KOLOMMEN EN 2 RIJEN -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="20" RowDefinitions="*,*">

                    <!-- KOLOM 1: Gegevens Reserveringshouder -->
                    <Grid ColumnDefinitions="*" ColumnSpacing="20" RowSpacing="20" RowDefinitions="*,*">
                        <Frame Grid.Column="0" Grid.Row="0" BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                            <VerticalStackLayout Spacing="10">
                                <Label FontSize="20" FontAttributes="Bold" Margin="0,0,0,5">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="Gegevens reserveringshouder " TextColor="Black"/>
                                            <Span Text="(vereist)" TextColor="Red"/>
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>

                                <!-- Naam -->
                                <VerticalStackLayout Spacing="2">
                                    <Label FontSize="16">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Volledige naam " TextColor="Black"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Entry Text="{Binding Naam}" Placeholder="Bijvoorbeeld: Jacob Arie Romkes" TextColor="Black" BackgroundColor="#f0f0f0"/>
                                    <Label Text="{Binding NaamFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsNaamFoutZichtbaar}"/>
                                </VerticalStackLayout>

                                <!-- Geboortedatum -->
                                <VerticalStackLayout Spacing="2">
                                    <Label FontSize="16">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Geboortedatum " TextColor="Black"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <DatePicker Date="{Binding Geboortedatum}" TextColor="Black" BackgroundColor="#f0f0f0" MaximumDate="{x:Static sys:DateTime.Today}"/>
                                    <Label Text="{Binding GeboortedatumFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsGeboortedatumFoutZichtbaar}"/>
                                </VerticalStackLayout>

                                <!-- Email -->
                                <VerticalStackLayout Spacing="2">
                                    <Label FontSize="16">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="E-mailadres " TextColor="Black"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Entry Text="{Binding Emailadres}" Keyboard="Email" Placeholder="bijvoorbeeld: jacobarieromkes@coolmail.com" TextColor="Black" BackgroundColor="#f0f0f0"/>
                                    <Label Text="{Binding EmailadresFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsEmailadresFoutZichtbaar}"/>
                                </VerticalStackLayout>

                                <!-- Telefoon -->
                                <VerticalStackLayout Spacing="2">
                                    <Label FontSize="16">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Telefoonnummer " TextColor="Black"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Entry Text="{Binding Telefoonnummer}" Keyboard="Telephone" Placeholder="0612345678" TextColor="Black" BackgroundColor="#f0f0f0"/>
                                    <Label Text="{Binding TelefoonnummerFoutmelding}" TextColor="Red" FontSize="12" IsVisible="{Binding IsTelefoonnummerFoutZichtbaar}"/>
                                </VerticalStackLayout>
                            </VerticalStackLayout>
                        </Frame>
                        <Frame Grid.Column="0" Grid.Row="1" BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                            <VerticalStackLayout>
                                <VerticalStackLayout Grid.Column="0" Spacing="0">
                                    <Label FontSize="16" Text="Gasten toevoegen" Margin="5" TextColor="Black"/>
                                    <Label FontSize="16" Padding="10" Text="Toegevoegde gasten" BackgroundColor="#f0f0f0" TextColor="Black"/>
                                    <CollectionView ItemsSource="{Binding GastenLijst}" Margin="10" SelectionMode="None">
                                        <CollectionView.ItemTemplate>
                                            <DataTemplate x:DataType="models:Gast">
                                                <Grid ColumnDefinitions="*, Auto, Auto" Padding="5" VerticalOptions="Center">
                                                    <Label Text="{Binding Naam}" Grid.Column="0" FontSize="16" TextColor="Black" VerticalOptions="Center"/>
                                                    <Label Text="{Binding Geboortedatum, StringFormat='{0:dd-MM-yyyy}'}" Grid.Column="1" FontSize="16" TextColor="Gray" VerticalOptions="Center" Margin="10,0"/>
                                                    <Button Grid.Column="2"
                                                            Text="ðŸ—‘"
                                                            TextColor="Red"
                                                            BackgroundColor="Transparent"
                                                            FontSize="18"
                                                            Padding="0"
                                                            HeightRequest="40"
                                                            WidthRequest="40"
                                                            Command="{Binding Source={RelativeSource AncestorType={x:Type vm:ReserveringsoverzichtViewModel}}, Path=VerwijderGastCommand}"
                                                            CommandParameter="{Binding .}" />
                                                </Grid>
                                            </DataTemplate>
                                        </CollectionView.ItemTemplate>
                                    </CollectionView>
                                </VerticalStackLayout>
                                <Button Grid.Column="0"
                                        Text="+"
                                        Command="{Binding ToevoegenGastCommand}"
                                        BackgroundColor="#0a5dc9"
                                        TextColor="White"
                                        FontAttributes="Bold"
                                        HorizontalOptions="End"
                                        WidthRequest="200"
                                        Margin="10"
                                        IsEnabled="{Binding GastToevoegenEnabled}"/>
                            </VerticalStackLayout>
                        </Frame>
                    </Grid>

                    <!-- KOLOM 2: Gegevens Reservering -->
                    <Frame Grid.Column="1" BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                        <VerticalStackLayout Spacing="10">
                            <Label FontSize="20" FontAttributes="Bold" Margin="0,0,0,5">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Gegevens reservering " TextColor="Black" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>

                            <!-- Veld, Plaats en Periode -->
                            <Grid ColumnDefinitions="*,*"
                                  RowDefinitions="Auto,Auto"
                                  ColumnSpacing="10"
                                  RowSpacing="10">

                                <!-- Veld -->
                                <VerticalStackLayout Grid.Row="0" Grid.Column="0">
                                    <Label Text="Veld:" TextColor="Black" FontAttributes="Bold" />
                                    <Frame Padding="10" BackgroundColor="White" BorderColor="Gray" CornerRadius="5">
                                        <Label Text="{Binding FieldName}" TextColor="Black" />
                                    </Frame>
                                </VerticalStackLayout>

                                <!-- Plaats -->
                                <VerticalStackLayout Grid.Row="0" Grid.Column="1">
                                    <Label Text="Plaats:" TextColor="Black" FontAttributes="Bold" />
                                    <Frame Padding="10" BackgroundColor="White" BorderColor="Gray" CornerRadius="5">
                                        <Label Text="{Binding StaanplaatsInfo}" TextColor="Black" LineBreakMode="TailTruncation" />
                                    </Frame>
                                </VerticalStackLayout>

                                <!-- Periode -->
                                <VerticalStackLayout Grid.Row="1" Grid.ColumnSpan="2">
                                    <Label Text="Periode:" TextColor="Black" FontAttributes="Bold" />
                                    <Frame Padding="10" BackgroundColor="White" BorderColor="Gray" CornerRadius="5">
                                        <Label Text="{Binding PeriodDescription}" TextColor="Gray" FontAttributes="Italic" />
                                    </Frame>
                                </VerticalStackLayout>

                            </Grid>

                            <BoxView HeightRequest="1" Color="LightGray" Margin="0,5" />

                            <!-- Accommodatie Kiezen -->
                            <Label FontSize="20" FontAttributes="Bold" Margin="0,0,0,5">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Accommodatie " TextColor="Black" />
                                        <Span Text="(vereist)" TextColor="Red" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>

                            <CollectionView ItemsSource="{Binding Accommodaties}"
                                            SelectionMode="Single"
                                            SelectedItem="{Binding SelectedAccommodatie, Mode=TwoWay}">

                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="4" />
                                </CollectionView.ItemsLayout>

                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Border Stroke="Gray" StrokeThickness="1" Margin="2" Padding="10" BackgroundColor="White" StrokeShape="RoundRectangle 5">
                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup Name="CommonStates">
                                                    <VisualState Name="Normal">
                                                        <VisualState.Setters>
                                                            <Setter TargetName="SelectedCheck" Property="IsVisible" Value="False" />
                                                        </VisualState.Setters>
                                                    </VisualState>

                                                    <VisualState Name="Selected">
                                                        <VisualState.Setters>
                                                            <Setter Property="BackgroundColor" Value="#cce5ff" />
                                                            <Setter Property="Stroke" Value="#0a5dc9" />
                                                            <Setter TargetName="SelectedCheck" Property="IsVisible" Value="True" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                </VisualStateGroup>
                                            </VisualStateManager.VisualStateGroups>

                                            <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="10">
                                                <!-- Naam -->
                                                <Label Text="{Binding Name}"
                                                       VerticalOptions="Center"
                                                       TextColor="Black"
                                                       FontSize="16" />

                                                <!-- Prijs -->
                                                <Label Text="{Binding Prijs, StringFormat='â‚¬{0:F2},- per nacht'}"
                                                       Grid.Column="1"
                                                       VerticalOptions="Center"
                                                       TextColor="Gray"
                                                       FontSize="14" />

                                                <!-- Vinkje als geselecteerd -->
                                                <Label x:Name="SelectedCheck"
                                                       Text="âœ”"
                                                       Grid.Column="2"
                                                       TextColor="#0a5dc9"
                                                       FontAttributes="Bold"
                                                       IsVisible="False" />
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                            <BoxView HeightRequest="1" Color="LightGray" Margin="0,5" />

                            <!-- VOORZIENINGEN SECTIE -->
                            <Label FontSize="20" FontAttributes="Bold" Margin="0,0,0,5">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Voorzieningen " TextColor="Black" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>

                            <!-- Stroom -->
                            <Border Stroke="Gray"
                                    StrokeThickness="1"
                                    Padding="10"
                                    BackgroundColor="White"
                                    StrokeShape="RoundRectangle 5"
                                    IsVisible="{Binding IsStroomMogelijk}">

                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">

                                    <!-- Checkbox -->
                                    <CheckBox Grid.Column="0"
                                              IsChecked="{Binding KiestStroom}"
                                              Color="#0a5dc9"
                                              VerticalOptions="Center" />

                                    <!-- Naam -->
                                    <Label Grid.Column="1"
                                           Text="âš¡ Stroom"
                                           VerticalOptions="Center"
                                           TextColor="Black"
                                           FontSize="16" />

                                    <!-- Prijs -->
                                    <Label Grid.Column="2"
                                           Text="{Binding StroomPrijsPerNacht, StringFormat='â‚¬{0:F2},- per nacht'}"
                                           VerticalOptions="Center"
                                           TextColor="Gray"
                                           FontSize="14" />
                                </Grid>
                            </Border>

                            <!-- Water -->
                            <Border Stroke="Gray"
                                    StrokeThickness="1"
                                    Padding="10"
                                    BackgroundColor="White"
                                    StrokeShape="RoundRectangle 5"
                                    IsVisible="{Binding IsWaterMogelijk}">

                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">

                                    <!-- Checkbox -->
                                    <CheckBox Grid.Column="0"
                                              IsChecked="{Binding KiestWater}"
                                              Color="#0a5dc9"
                                              VerticalOptions="Center" />

                                    <!-- Naam -->
                                    <Label Grid.Column="1"
                                           Text="ðŸ’§ Water"
                                           VerticalOptions="Center"
                                           TextColor="Black"
                                           FontSize="16" />

                                    <!-- Prijs -->
                                    <Label Grid.Column="2"
                                           Text="{Binding WaterPrijsPerNacht, StringFormat='â‚¬{0:F2},- per nacht'}"
                                           VerticalOptions="Center"
                                           TextColor="Gray"
                                           FontSize="14" />
                                </Grid>
                            </Border>

                        </VerticalStackLayout>
                    </Frame>

                </Grid>

                <!-- Totaalprijs info -->
                <Frame BorderColor="LightGray" BackgroundColor="#fafafa" Padding="15" CornerRadius="10" VerticalOptions="Start">
                    <VerticalStackLayout Spacing="10">

                        <Label Text="Info totaalprijs:"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="Black" />

                        <CollectionView ItemsSource="{Binding PrijsInfo}"
                                        SelectionMode="None"
                                        HeightRequest="160">
                            <CollectionView.ItemsLayout>
                                <LinearItemsLayout Orientation="Vertical" ItemSpacing="6" />
                            </CollectionView.ItemsLayout>

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Text="{Binding Omschrijving}"
                                               TextColor="Black"
                                               FontSize="14" />

                                        <Label Text="{Binding Bedrag, StringFormat='â‚¬{0:F2}'}"
                                               Grid.Column="1"
                                               TextColor="Gray"
                                               FontAttributes="Bold"
                                               FontSize="14" />
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <BoxView HeightRequest="1" Color="LightGray" Margin="0,5" />

                        <Label Text="{Binding TotaalPrijs, StringFormat='Totaalprijs: â‚¬{0:F2}'}"
                               FontSize="24"
                               FontAttributes="Bold"
                               TextColor="Black"
                               Margin="5,0,0,0" />

                    </VerticalStackLayout>
                </Frame>

                <!-- Knoppenbalk -->
                <Grid ColumnDefinitions="Auto, *" Margin="0,10,0,0">
                    <Button Grid.Column="0"
                            Text="Terug"
                            Command="{Binding GoBackCommand}"
                            BackgroundColor="Gray"
                            TextColor="White"
                            WidthRequest="100" />

                    <Button Grid.Column="1"
                            Text="Voltooi reservering"
                            Command="{Binding VoltooiReserveringCommand}"
                            BackgroundColor="#0a5dc9"
                            TextColor="White"
                            FontAttributes="Bold"
                            HorizontalOptions="End"
                            WidthRequest="200" />
                </Grid>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>